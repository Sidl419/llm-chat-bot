# llm-chat-bot

Веб-сервис, способный отвечать на вопросы пользователей на основе базы знаний. Для запуска сервиса необходимо скачать в корневую папку файл [модели Llama](https://huggingface.co/TheBloke/Llama-2-7b-Chat-GGUF/blob/main/llama-2-7b-chat.Q4_K_M.gguf) и [документы](https://drive.google.com/drive/folders/1RaGIjeWaC8ZNtlfYdHEj-6Vy7L4cHOEE), по которым ведётся поиск (в нашем случае условия Тинькофф Банка), они должны лежать в папке `/tinkoff-terms`.

Ключевые моменты решения:

* Сервис работает на базе CPU.
* База знаний содержится в векторной БД Chroma, эмбеддинги для поиска вычисляются на основе модели `sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2`. При поступлении нового запроса от пользователя сначала достаются ответы из БД, после чего они передаются в контекст модели.
* История диалога с конкретным пользователем хранится в БД Redis по ключу `user_id`.
* Интерфейс реализован через FastAPI.

Для контроля зависимостей в проекте использовался Poetry. Код фоматировался при помощи black.

## Работа с Docker

Контейнер собирается по команде

```[bash]
docker build --tag llm_username:v1 .
```

Сервис можно запустить с помощью следующей команды

```[bash]
docker run --publish 8080:8080 llm_username:v1
```

## Примеры работы

Q: Когда осуществляется начисление процентов на остаток средств

> A: Днем следующий после даты зачисления денежных средств на счет вклада или даты проlonгации вкладa клиента на новый срок

Q: Какие валюты ПС являются рассчетными

> A: Привет! Важно понимать, что валюты ПС, которые мы используем для расчетов, могут меняться в зависимости от условий рынка. Однако, в настоящее время, следующие валюты считаются расчетными: USD, EUR, GBP, JPY, CNY, AUD, NZD, CHF, CAD, MXN, BRL, RUB.
Обратите внимание, что в случае выполнения операции в валюте, отличной от валюты Договора кредитной карты и не являющейся одной из расчетных валют ПС, сумма операции конвертируется в расчетную валюту ПС по курсу ПС. Если у вас есть дополнительные вопросы, не стесняйтесь задавать их мне!

Q: Какой сейчас процент по кредиту?

> A: Добрый день! По вашему запросу, процент по кредиту составляет 24,176% - 33,013% годовых, в зависимости от количества и длины кредитования. Однако, я должен отметить, что это только общая информация, и проценты могут отличаться в зависимости от индивидуальных условий каждого кредитора. Если у вас есть конкретные вопросы или потребности, пожалуйста, не стесняйтесь задавать их мне.
